<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<title>学位学历认证管理系统-学生</title>
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">    
	<link rel="stylesheet" type="text/css" href="/static/stylesheets/head.css" />
	<link rel="stylesheet" type="text/css" href="/static/stylesheets/bottom.css" />
	<link href="/static/layui/css/layui.css" rel="stylesheet" type="text/css">  
	<link rel="stylesheet" type="text/css" href="/static/stylesheets/certificate.css" />
	<style>
		body{
			background:none
		}
	</style>
</head>
 
<body>
	<%-include("../head.ejs")%>
	<!-- 学生证书区块链证书存证 -->
	<section>
		<div class="layui-container" id="certificate" >
			<div class="layui-row">
				<div class="" style="padding: 20px;" id="print_certificateinfor">
					<table class="layui-table cer_table" cellspacing="0" cellpadding="0">
					  <colgroup>
						  <col width="50">
						  <col width="120">
						  <col width="200">
						  <col width="50">
					  </colgroup>
					  <tbody >
						<tr>
						  <td colspan="4"></td>
						</tr>
						<tr>
						  <td colspan="4" style="text-align: center;">&nbsp;</td>
						</tr>
						<tr>
						  <td></td>
						  <td colspan="2"><h1 class="cer_table_title">学位区块链存证证书</h1></td>
						  <td></td>
						</tr>
						<tr>
						  <td></td>
						  <td colspan="2">本证书表明毕业生学位证书数据已采用VNT Chain区块链技术转换为不可篡改的特征值，并上传至区块链进行存证。已存证的相关电子数据如需查验，可通过信诣学位学历认证管理系统进行。</td>
						  <td></td>
						</tr>
						<tr>
						  <td></td>
						  <td class="cer_table_td_title">存证方：</td>
						  <td>信诣学位学历认证管理系统</td>
						  <td></td>
						</tr>
						<tr>
						  <td></td>
						  <td class="cer_table_td_title">姓名：</td>
						  <td><%= certificate.name %></td>
						  <td></td>
						</tr>
						<tr>
						  <td></td>
						  <td class="cer_table_td_title">学校名称：</td>
						  <td><%= certificate.school %></td>
						  <td></td>
						</tr>
						<tr>
						  <td></td>
						  <td class="cer_table_td_title">学位类别：</td>
						  <td><%= certificate.degreetype %></td>
						  <td></td>
						</tr>
						<tr>
						  <td></td>
						  <td class="cer_table_td_title">毕业年月：</td>
						  <td><%= certificate.graduationdate %></td>
						  <td></td>
						</tr>
						<tr>
						  <td></td>
						  <td class="cer_table_td_title">专业：</td>
						  <td><%= certificate.major %></td>
						  <td></td>
						</tr>
						<tr>
						  <td></td>
						  <td class="cer_table_td_title">证书编号：</td>
						  <td><%= certificate.certificatenumber %></td>
						  <td></td>
						</tr>

						<!-- 说明 -->
						<tr>
							<td></td>
							<td colspan="2">此证书对应存证内容已加盖可信时间戳，并在信诣学位学历认证管理系统及杭州维特链科技有限公司提供的维特链上同步存证。 <div style="float: right;">
							  	<!-- <img src="./img/seal.png"  width="200" height="100" /> -->
								<div class="seal-result seal-result-fail ">
									<canvas id="canvas" width="140" height="140"></canvas>
								</div>
							  </div>
							</td>
							<td></td>
						  </tr>
						  <tr>
						  	<td></td>
						  	<td colspan="2">
								<div  class="cer_table_td_title">
								  <!-- <p style="text-align: center;	">扫码查验</p> -->
								  <div class="cer_table_QRcode">
									  <div class="cer_table_codetext">方式一：<br>扫码直接核验</div>
									<img src="/student/qrcode" style="height: 90px;" />
								  </div>
								  <div class="cer_table_QRcode">
									  <div class="cer_table_codetext">方式二：<br>官方小程序</div>
									<img src="/static/images/small_program_code.png" style="height: 90px;" />
								  </div>
							  </div></td>
						  	<td></td>
						    </tr>

						<!-- 区块链值 -->
						<tr>
							<td></td>
						  <td colspan="2">
							 
							  <div  style="font-size: 12px;">
								<div>区块高度：<%= certificate.blockNumber %></div>
								  <div >
								<label>交易Hash值：</label>
								<span><%= certificate.txhash %></span>
								</div>
							  </div>
							
						  </td>
						  <td></td>
						</tr>

						<tr>
						  <td colspan="4">
						  </td>
						</tr>

						<tr>
							<td colspan="4">
							</td>
						  </tr>
					  </tbody>
					</table>
	
				</div>

				<div class="">
					<div style="text-align: center;width: 100%;">
						<button class="layui-btn layui-btn-fluid" style="border-radius: 20px;background-color: #3887e5;width: 200px;" onclick="window.history.go(-1)">
						上一页
						</button>
						<button class="layui-btn layui-btn-fluid" style="border-radius: 20px;background-color: #3887e5;width: 200px;" onclick="print_certificate()">
						打印
						</button>
					</div>
				</div>
				
		
			</div>
		</div>
		
	</section>


    <%-include("../foot.ejs")%>

    <script language="javascript" src="/static/lib/jqprint/jquery-1.4.4.min.js"></script>
	<script language="javascript" src="/static/lib/jqprint/jquery.jqprint-0.3.js"></script>
	<script>
		// 打印存证证书
		function print_certificate(){
		$("#print_certificateinfor").jqprint();
}

	</script>

<script src="/static/layui/layui.js"></script>

<script>
    
    layui.use(['form','laydate','element'], function(){
      var $ = layui.jquery,
          $ = layui.$,
          element = layui.element//导航的hover效果、二级菜单等功能，需要依赖element模块
          ;
          //修改密码
          $("#changePasswordBtn").click(function(){
              $.get('/changePassword',(res)=>{
                  var index = layer.open({
                title: '修改密码',
                type: 1,
                shade: 0.2,
                maxmin:true,
                shadeClose: true,
                area:['500px','400px'],
                content:res
                    
            });
                $(window).on("resize", function () {
                    layer.full(index);
                });
             })
        })
		  
		  //用户退出
		  	$(".login-out").click(function(){
		  		layer.confirm("确认退出系统吗？",{
					icon:3, title: "提示",
					}, 
					function(index){
						//关闭询问框
						layer.close(index);
						//跳转
						window.location.href = "/logout";
		  		})
		  	});
        
		});
        
	</script>

	<script name="自定义印章">
 
	   var canvas = document.getElementById("canvas");
	   var context = canvas.getContext('2d');
 
	   var text = "已存证";
	   var companyName = "信诣学位学历认证管理系统";
 
	   // 绘制印章边框
	   var width = canvas.width / 2;
	   var height = canvas.height / 2;
	   context.lineWidth = 5;
	   context.strokeStyle = "#f00";
	   context.beginPath();
	   context.arc(width, height, 70, 0, Math.PI * 2);//宽、高、半径
	   context.stroke();
 
	   //画五角星
	   create5star(context,width,height,20,"#f00",0);
 
		// 绘制印章名称
		context.font = '18px 宋体';
		context.textBaseline = 'middle';//设置文本的垂直对齐方式
		context.textAlign = 'center'; //设置文本的水平对对齐方式
		context.lineWidth=1;
		context.strokeStyle = '#f00';
		context.strokeText(text,width,height+50);
 
		// 绘制印章单位  
		context.translate(width,height);// 平移到此位置,
		context.font = '20px 宋体';
		var  count = companyName.length;// 字数
		var  angle = 4*Math.PI/(3*(count - 1));// 字间角度 
		var chars = companyName.split("");
		var c;
	   for (var i = 0; i < count; i++) {
		   c = chars[i];// 需要绘制的字符   
		   if (i == 0) {
			   context.rotate(5 * Math.PI / 6);
 
		   } else{
			   context.rotate(angle);
		   }
 
		   context.save();
		   context.translate(55	, 0);// 平移到此位置,此时字和x轴垂直，公司名称和最外圈的距离
		   context.rotate(Math.PI / 2);// 旋转90度,让字平行于x轴
		   context.strokeText(c, 0, 0);// 此点为字的中心点
		   context.restore();
	   }
 
	   //绘制五角星
		function create5star(context, sx, sy, radius, color, rotato) {
			context.save();
			context.fillStyle = color;
			context.translate(sx, sy);//移动坐标原点
			context.rotate(Math.PI + rotato);//旋转
			context.beginPath();//创建路径
			var x = Math.sin(0);
			var y = Math.cos(0);
			var dig = Math.PI / 5 * 4;
			for (var i = 0; i < 5; i++) {//画五角星的五条边
				var x = Math.sin(i * dig);
				var y = Math.cos(i * dig);
				context.lineTo(x * radius, y * radius);
			}
			context.closePath();
			context.stroke();
			context.fill();
			context.restore();
		}
 
</script>
	


</body>
</html>